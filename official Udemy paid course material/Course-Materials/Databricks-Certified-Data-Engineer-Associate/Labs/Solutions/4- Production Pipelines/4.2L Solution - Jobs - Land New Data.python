{"version":"NotebookV1","origId":325513904362797,"name":"4.2L Solution - Jobs - Land New Data","language":"python","commands":[{"version":"CommandV1","origId":325513904362798,"guid":"8bea26da-90e6-4c2e-af22-493f45cc9ca5","subtype":"command","commandType":"auto","position":0.5,"command":"%md\n\n## Lab Solution: Creating a multi-task job\n\nIn this lab, we will create a job that has 2 tasks:\n1. The current notebook that lands a new batch of data in the lab dataset directory\n1. The Delta Live Table pipeline created in the previous lab to processes this data\n\n* Help: <a href=\"https://docs.databricks.com/workflows/jobs/create-run-jobs.html\" target=\"_blank\">Databricks Jobs documentation</a>.","commandVersion":56,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"46899dec-0606-43a6-b641-7c74e3ff0b15"},{"version":"CommandV1","origId":325513904362799,"guid":"d2b3c463-51bf-45a6-9257-3e7c0d1eef3c","subtype":"command","commandType":"auto","position":0.75,"command":"%md-sandbox\n\n<div  style=\"text-align: center; line-height: 0; padding-top: 9px;\">\n  <img src=\"https://raw.githubusercontent.com/derar-alhussein/Databricks-Certified-Data-Engineer-Associate/main/Labs/Includes/images/school_job.png\">\n</div>","commandVersion":6,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"233a730b-d5d0-46cd-b858-45ea0eb38f09"},{"version":"CommandV1","origId":325513904362800,"guid":"1a8639fc-ac1a-4740-8e20-8baa15c14673","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n#### Q1- Configuring Task 1 -  Land New Data\n\n\nFrom the **Workflows** button on the sidebar, under the **Jobs** tab, click the **Create Job** button.\n\n<br>\n\n1. Set the job name in the top-left of the screen to **School Job** \n1. Configure the first task as specified below:\n| Setting | Value |\n|--|--|\n| Task name | Enter **Land New Data** |\n| Type | Choose **Notebook** |\n| Source | Choose **Workspace** |\n| Path | Use the navigator to choose the current notebook (4.2L - Jobs - Land New Data) |\n| Cluster | Select your cluster from the dropdown, under **Existing All Purpose Clusters** |\n\n\n<br>\n\n3. Click the **Create** button","commandVersion":126,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b6a598c0-c14a-43cd-b52d-e1d7cbad257b"},{"version":"CommandV1","origId":325513904362801,"guid":"5f45d55b-7c75-4c64-bc9d-5974405db36d","subtype":"command","commandType":"auto","position":1.5,"command":"%md\n#### Q2- Configuring Task 2 - DLT pipeline\n\n<br>\n\n1. Click the add button (**+**) to add a new **Delta Live Tables pipeline** task \n1. Configure the task:\n\n| Setting | Value |\n|--|--|\n| Task name | Enter **DLT pipeline** |\n| Type | Choose **Delta Live Tables pipeline** |\n| Pipeline | Choose the DLT pipeline created in the previous lab |\n| Depends on | Choose **Land New Data**, which is the previous task we defined above |\n\n<br>\n\n3. Click the **Create task** button","commandVersion":65,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"03b9bc44-1483-45f7-9484-5865e3b3d637"},{"version":"CommandV1","origId":325513904362802,"guid":"2823caa0-bfda-4ea2-bc67-b68847b682c3","subtype":"command","commandType":"auto","position":1.75,"command":"%md\n#### Q3- Run the job \n\nClick the **Run now** button in the top right to run this job. From the **Runs** tab, check your job run","commandVersion":30,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"9bce4858-b2cf-48fa-8c3f-e055b898dbdb"},{"version":"CommandV1","origId":325513904362803,"guid":"adf1c3f3-8777-470a-88e1-490712772b6b","subtype":"command","commandType":"auto","position":1.875,"command":"%md\n#### Q4- Review the finished job \n\nOnce all tasks completed successfully, review the contents of each task to verify its result","commandVersion":18,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"29ffeace-f1e3-4953-93cf-b3bec18121df"},{"version":"CommandV1","origId":325513904362804,"guid":"e26b0133-a13d-45d5-b1ea-ab7e93098ccc","subtype":"command","commandType":"auto","position":1.90625,"command":"%md\n> **Note**: The below cells are to be run as part of the **Task 1** to land new batch of data in the dataset directory","commandVersion":29,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b6debd2a-d526-42b2-9fec-c880338848fc"},{"version":"CommandV1","origId":325513904362805,"guid":"eef761e4-c81e-400f-a0af-2bbf3f8130c4","subtype":"command","commandType":"auto","position":1.9375,"command":"%run ../Includes/Setup-Lab","commandVersion":7,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"2c80a1da-8e26-4f69-be9e-5b3449a45a47"},{"version":"CommandV1","origId":325513904362806,"guid":"d1ca97d9-df51-4057-9673-025fac669f81","subtype":"command","commandType":"auto","position":3.0,"command":"load_new_json_data()","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"8797fb56-6e21-466c-9bae-420b0acf3f2f"}],"dashboards":[],"guid":"7fabdc52-7dbc-417a-b10a-4fb40e82c5f1","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":2},"reposExportFormat":"SOURCE"}