{"version":"NotebookV1","origId":325513904362807,"name":"4.3L Solution - Databricks SQL","language":"sql","commands":[{"version":"CommandV1","origId":325513904362808,"guid":"6510dec9-f8b0-4e05-a43a-ded20abaf607","subtype":"command","commandType":"auto","position":0.5,"command":"%md\n\n## Lab Solution: Design a Dashboard with DBSQL\n\nIn this lab, we will design a dashboard in DBSQL that has 2 graphs:\n1. Bar graph that shows the number of students per country\n1. Line graph that shows the daily enrollments amount\n\n* Help: <a href=\"https://docs.databricks.com/sql/index.html#what-is-databricks-sql\" target=\"_blank\">Databricks SQL documentation</a>.","commandVersion":78,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"46899dec-0606-43a6-b641-7c74e3ff0b15"},{"version":"CommandV1","origId":325513904362809,"guid":"7907064c-80d8-465c-8d84-0699d8ebb2ec","subtype":"command","commandType":"auto","position":0.5625,"command":"%md-sandbox\n\n<div  style=\"text-align: center; line-height: 0; padding-top: 9px;\">\n  <img src=\"https://raw.githubusercontent.com/derar-alhussein/Databricks-Certified-Data-Engineer-Associate/main/Labs/Includes/images/dashboard.png\" style=\"width: 1100\">\n</div>","commandVersion":8,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"98773fa6-8d60-4b57-9ce0-3aa2664dfec5"},{"version":"CommandV1","origId":325513904362810,"guid":"86d2dcbb-2bbe-47c0-90f7-cd2a3eef1b67","subtype":"command","commandType":"auto","position":0.625,"command":"%md\n#### Q1 - Working with queries in SQL Editor\n\nRun the the below query in **SQL Editor** in Databricks SQL, and then save it with the name **Student Counts**","commandVersion":46,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"1ab7c2d2-9dc3-4106-8aeb-ee9cdf228611"},{"version":"CommandV1","origId":325513904362811,"guid":"6a0ab815-9272-43f2-9a0f-36a63f40a783","subtype":"command","commandType":"auto","position":0.875,"command":"SELECT profile:address:country as country, count(student_id) AS students_count\nFROM de_associate_school.students\nGROUP BY profile:address:country\nORDER BY students_count DESC\nLIMIT 10","commandVersion":42,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"747f4fb2-b338-4d58-8ea2-6aa96e140037"},{"version":"CommandV1","origId":325513904362812,"guid":"96d61857-7406-4b9c-b8b1-62cc1c2396eb","subtype":"command","commandType":"auto","position":0.9375,"command":"%md\n#### Q2 - Creating a Bar Graph Visualization\n\nCreate a bar graph that shows the number of students per country\n\n<br>\n<img src=\"https://raw.githubusercontent.com/derar-alhussein/Databricks-Certified-Data-Engineer-Associate/main/Labs/Includes/images/bar_graph.png\" style=\"width: 100\">\n\n##### Anwser:\nSteps:\n1. Click the Add butoon (**+**) next to the results tab, and select **Visualization** from the dialog box\n1. Select **`Bar`** for the **Visualization Type**\n1. Set **`country`** for the **X Column**\n1. Under **Y columns** click **Add column**, and set it to **`students_count`**\n1. Click **Save**\n1. Finally, set the title of the graph to **Student Counts Viz**","commandVersion":137,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"42c524e5-b262-4ee8-93b8-a952ddcc93c7"},{"version":"CommandV1","origId":325513904362813,"guid":"38e67b5c-c5c3-4f6f-ba2c-5fa75d079b8c","subtype":"command","commandType":"auto","position":0.96875,"command":"%md\n#### Q3 - Creating a New Dashboard\n\nAdd the above graph to a new dashboard named **Students Statistics**\n\n##### Anwser:\n\nSteps:\n1. Click the three vertical dots button at the top of the graph and select **Add to Dashboard**.\n1. Click the **Create new dashboard** option\n1. Name your dashboard **Students Statistics**\n1. Click **Save**\n1. With the new dashboard selected as the target, click **OK** to add your visualization","commandVersion":44,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e2cc4e60-3f83-4d6f-94b4-58c70d41bb68"},{"version":"CommandV1","origId":325513904362814,"guid":"f3835967-1a15-450b-88ec-2df2ec1a6a4d","subtype":"command","commandType":"auto","position":0.984375,"command":"%md\n#### Q4 - Creating a Line Plot Visualization\n\n1. Run the the below query in a new query tab in the **SQL Editor**, and then save it with the name **Daily Sales**","commandVersion":68,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"aea97b5a-8800-483b-82af-9ad38792b0f4"},{"version":"CommandV1","origId":325513904362815,"guid":"36dc8718-172e-4631-b4c0-c7ec89124f4e","subtype":"command","commandType":"auto","position":0.9921875,"command":"SELECT cast(from_unixtime(enroll_timestamp, 'yyyy-MM-dd HH:mm:ss') AS date) enroll_timestamp,\n        sum(total) AS enrollments_amount\nFROM de_associate_school.enrollments n\nINNER JOIN de_associate_school.students s ON s.student_id = n.student_id\nGROUP BY enroll_timestamp","commandVersion":64,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"12044b53-1de2-4c28-a7bc-3deb713dd5a3"},{"version":"CommandV1","origId":325513904362816,"guid":"8839da44-2469-4bfd-8aca-1bc54a94322c","subtype":"command","commandType":"auto","position":0.99609375,"command":"%md\n\n2. Create a Line Plot Visualization that shows the daily enrollments amount\n\n\n<br>\n<img src=\"https://raw.githubusercontent.com/derar-alhussein/Databricks-Certified-Data-Engineer-Associate/main/Labs/Includes/images/line_graph.png\" style=\"width: 100\">\n\n\n##### Anwser:\n\nSteps:\n1. Click the **Add Visualization** button\n1. Select **`Line`** for the **Visualization Type**\n1. Set **`enroll_timestamp`** for the **X Column**\n1. Under **Y columns** click **Add column**, and set it to **`enrollments_amount`**\n1. Click **Save**\n1. Finally, set the title of the graph to **Daily Sales Viz**\n1. Click the three vertical dots button at the top of the graph and select **Add to Dashboard**.\n1. Select the dashboard **Students Statistics** created above\n1. Click **OK** to add your visualization","commandVersion":80,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"92e72cc3-2009-4c6c-b202-4eef52dc5440"},{"version":"CommandV1","origId":325513904362817,"guid":"241b08a4-35ab-4b0e-b296-74a61169ebe6","subtype":"command","commandType":"auto","position":0.998046875,"command":"%md\n#### Q5 - Review your Dashboard\n\nOpen your Dashboard and refresh its underlaying data\n\n##### Anwser:\n\nSteps:\n1. Click on the **Dashboards** button on left side bar\n1. Find the dashboard **Students Statistics** created earlier. Click to open it\n1. Click the **Refresh** button to update your dashboard","commandVersion":49,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b3bc74a4-6b55-4d6d-8895-941160b4369b"}],"dashboards":[],"guid":"f7dfc0bb-c7e7-4d4b-9288-0188eae91a2b","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":2},"reposExportFormat":"SOURCE"}