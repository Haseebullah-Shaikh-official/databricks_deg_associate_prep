{"version":"NotebookV1","origId":325513904362754,"name":"1.2L Solution - Delta Lake","language":"sql","commands":[{"version":"CommandV1","origId":325513904362755,"guid":"12595667-e81f-4a8c-bb00-319af2d9d7ef","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n\n## Lab Solution: Delta Lake","commandVersion":26,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"dbb4fa54-11ec-499d-98b3-02660f8858b4"},{"version":"CommandV1","origId":325513904362756,"guid":"d91441d7-8e82-4f80-a772-71e99022352e","subtype":"command","commandType":"auto","position":1.5,"command":"%md\n#### Creating a Delta Table \n\nRun the cell below to create the **persons** Delta Table, and apply some operations on it.","commandVersion":32,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"614f592c-7d05-4eb3-81d5-909640720d23"},{"version":"CommandV1","origId":325513904362757,"guid":"94956cb3-b69e-4d5d-929b-08d8e38dd83a","subtype":"command","commandType":"auto","position":2.0,"command":"CREATE OR REPLACE TABLE persons\n  (id INT, name STRING, age INT);\n\nINSERT INTO persons\nVALUES \n  (1, \"Tom\", 18),\n  (2, \"Kumar\", 25);\n\nINSERT INTO persons\nVALUES \n  (3, \"Ali\", 50),\n  (4, \"Sandra\", 35);\n\nINSERT INTO persons\nVALUES \n  (5, \"Eric\", 28),\n  (6, \"Salma\", 42);\n\nUPDATE persons \nSET age = age + 10\nWHERE id = 1;\n\nDELETE FROM persons\nWHERE name = \"Eric\";","commandVersion":86,"state":"finished","results":{"type":"table","data":[[1]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"num_affected_rows","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1694392595244,"submitTime":1694392595218,"finishTime":1694392607327,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",1]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"2038b4f6-1c0d-4619-a1d7-ccb22219e912"},{"version":"CommandV1","origId":325513904362758,"guid":"ae14fe2b-8a47-4384-951d-bc1904e259a0","subtype":"command","commandType":"auto","position":2.5,"command":"%md\n#### Q1 - Querying Delta Lake table\n\nQuery the data in the **persons** table using **SELECT** statement","commandVersion":28,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"cca36101-4457-409b-bec0-d824cc305c19"},{"version":"CommandV1","origId":325513904362759,"guid":"4adee4cf-74f3-428b-ac8b-6867d0464d47","subtype":"command","commandType":"auto","position":3.0,"command":"-- Answer\nSELECT * FROM persons","commandVersion":17,"state":"finished","results":{"type":"table","data":[[3,"Ali",50],[4,"Sandra",35],[6,"Salma",42],[1,"Tom",28],[2,"Kumar",25]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"id","type":"\"integer\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"age","type":"\"integer\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1694392612646,"submitTime":1694392612625,"finishTime":1694392613246,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",5]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ca92c6c3-3240-42e6-b8d5-2edb8207c8ac"},{"version":"CommandV1","origId":325513904362760,"guid":"c2724181-97b7-41cc-84b6-dde3befd464b","subtype":"command","commandType":"auto","position":3.5,"command":"%md\n#### Q2 - Checking table history\n\nReview the history of the table transactions using the **DESCRIBE HISTORY** command","commandVersion":21,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"586ba232-fdbb-4770-804a-5cc917f61ccb"},{"version":"CommandV1","origId":325513904362761,"guid":"3481bb50-e639-4a7c-8a2f-a279dc954a26","subtype":"command","commandType":"auto","position":3.75,"command":"-- Answer\nDESCRIBE HISTORY persons","commandVersion":5,"state":"finished","results":{"type":"table","data":[[5,"2023-09-11T00:36:46.000+0000","4552316579568548","dalhussein@cegid.com","DELETE",{"predicate":"[\"(name#9610 = Eric)\"]"},null,["3139962348493833"],"0721-152616-bmdbdf6q",4,"WriteSerializable",false,{"numRemovedFiles":"1","numRemovedBytes":"1037","numCopiedRows":"1","numDeletionVectorsAdded":"0","numDeletionVectorsRemoved":"0","numAddedChangeFiles":"0","executionTimeMs":"814","numDeletedRows":"1","scanTimeMs":"519","numAddedFiles":"1","numAddedBytes":"1037","rewriteTimeMs":"295"},null,"Databricks-Runtime/13.2.x-scala2.12"],[4,"2023-09-11T00:36:43.000+0000","4552316579568548","dalhussein@cegid.com","UPDATE",{"predicate":"[\"(id#8973 = 1)\"]"},null,["3139962348493833"],"0721-152616-bmdbdf6q",3,"WriteSerializable",false,{"numRemovedFiles":"1","numRemovedBytes":"1034","numCopiedRows":"1","numDeletionVectorsAdded":"0","numDeletionVectorsRemoved":"0","numAddedChangeFiles":"0","executionTimeMs":"972","scanTimeMs":"508","numAddedFiles":"1","numUpdatedRows":"1","numAddedBytes":"1034","rewriteTimeMs":"463"},null,"Databricks-Runtime/13.2.x-scala2.12"],[3,"2023-09-11T00:36:41.000+0000","4552316579568548","dalhussein@cegid.com","WRITE",{"mode":"Append","statsOnLoad":"false","partitionBy":"[]"},null,["3139962348493833"],"0721-152616-bmdbdf6q",2,"WriteSerializable",true,{"numFiles":"1","numOutputRows":"2","numOutputBytes":"1037"},null,"Databricks-Runtime/13.2.x-scala2.12"],[2,"2023-09-11T00:36:39.000+0000","4552316579568548","dalhussein@cegid.com","WRITE",{"mode":"Append","statsOnLoad":"false","partitionBy":"[]"},null,["3139962348493833"],"0721-152616-bmdbdf6q",1,"WriteSerializable",true,{"numFiles":"1","numOutputRows":"2","numOutputBytes":"1037"},null,"Databricks-Runtime/13.2.x-scala2.12"],[1,"2023-09-11T00:36:38.000+0000","4552316579568548","dalhussein@cegid.com","WRITE",{"mode":"Append","statsOnLoad":"false","partitionBy":"[]"},null,["3139962348493833"],"0721-152616-bmdbdf6q",0,"WriteSerializable",true,{"numFiles":"1","numOutputRows":"2","numOutputBytes":"1034"},null,"Databricks-Runtime/13.2.x-scala2.12"],[0,"2023-09-11T00:36:35.000+0000","4552316579568548","dalhussein@cegid.com","CREATE OR REPLACE TABLE",{"partitionBy":"[]","description":null,"isManaged":"true","properties":"{}","statsOnLoad":"false"},null,["3139962348493833"],"0721-152616-bmdbdf6q",null,"WriteSerializable",true,{},null,"Databricks-Runtime/13.2.x-scala2.12"]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"version","type":"\"long\"","metadata":"{}"},{"name":"timestamp","type":"\"timestamp\"","metadata":"{}"},{"name":"userId","type":"\"string\"","metadata":"{}"},{"name":"userName","type":"\"string\"","metadata":"{}"},{"name":"operation","type":"\"string\"","metadata":"{}"},{"name":"operationParameters","type":"{\"type\":\"map\",\"keyType\":\"string\",\"valueType\":\"string\",\"valueContainsNull\":true}","metadata":"{}"},{"name":"job","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"jobId\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"jobName\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"jobRunId\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"runId\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"jobOwnerId\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}},{\"name\":\"triggerType\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"notebook","type":"{\"type\":\"struct\",\"fields\":[{\"name\":\"notebookId\",\"type\":\"string\",\"nullable\":true,\"metadata\":{}}]}","metadata":"{}"},{"name":"clusterId","type":"\"string\"","metadata":"{}"},{"name":"readVersion","type":"\"long\"","metadata":"{}"},{"name":"isolationLevel","type":"\"string\"","metadata":"{}"},{"name":"isBlindAppend","type":"\"boolean\"","metadata":"{}"},{"name":"operationMetrics","type":"{\"type\":\"map\",\"keyType\":\"string\",\"valueType\":\"string\",\"valueContainsNull\":true}","metadata":"{}"},{"name":"userMetadata","type":"\"string\"","metadata":"{}"},{"name":"engineInfo","type":"\"string\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1694392618825,"submitTime":1694392618804,"finishTime":1694392619801,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",6]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e1750318-e7fb-4d54-9f43-5c4f2165c740"},{"version":"CommandV1","origId":325513904362762,"guid":"b702a915-c932-4378-8f6d-88b9c89e5a86","subtype":"command","commandType":"auto","position":4.0,"command":"%md\n#### Q3- Checking table metadata\n\nReview the basic metadata information of the table using the **DESCRIBE DETAIL** command","commandVersion":41,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f62e54ed-c5b8-4cb4-995d-d6492a55c896"},{"version":"CommandV1","origId":325513904362763,"guid":"ab888290-eb48-4839-8fcb-05dee7e36a4e","subtype":"command","commandType":"auto","position":5.0,"command":"--Answer\nDESCRIBE DETAIL persons","commandVersion":11,"state":"finished","results":{"type":"table","data":[["delta","6277b0a7-d04a-48ff-b172-20991c421674","spark_catalog.default.persons",null,"dbfs:/user/hive/warehouse/persons","2023-09-11T00:36:35.517+0000","2023-09-11T00:36:46.000+0000",[],null,3,3108,{},1,2,["appendOnly","invariants"],{}]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"format","type":"\"string\"","metadata":"{}"},{"name":"id","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"description","type":"\"string\"","metadata":"{}"},{"name":"location","type":"\"string\"","metadata":"{}"},{"name":"createdAt","type":"\"timestamp\"","metadata":"{}"},{"name":"lastModified","type":"\"timestamp\"","metadata":"{}"},{"name":"partitionColumns","type":"{\"type\":\"array\",\"elementType\":\"string\",\"containsNull\":true}","metadata":"{}"},{"name":"clusteringColumns","type":"{\"type\":\"array\",\"elementType\":\"string\",\"containsNull\":true}","metadata":"{}"},{"name":"numFiles","type":"\"long\"","metadata":"{}"},{"name":"sizeInBytes","type":"\"long\"","metadata":"{}"},{"name":"properties","type":"{\"type\":\"map\",\"keyType\":\"string\",\"valueType\":\"string\",\"valueContainsNull\":true}","metadata":"{}"},{"name":"minReaderVersion","type":"\"integer\"","metadata":"{}"},{"name":"minWriterVersion","type":"\"integer\"","metadata":"{}"},{"name":"tableFeatures","type":"{\"type\":\"array\",\"elementType\":\"string\",\"containsNull\":true}","metadata":"{}"},{"name":"statistics","type":"{\"type\":\"map\",\"keyType\":\"string\",\"valueType\":\"long\",\"valueContainsNull\":true}","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1694392632955,"submitTime":1694392632933,"finishTime":1694392633477,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",1]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"f1f79aed-52cc-47a4-9b69-857238785371"},{"version":"CommandV1","origId":325513904362764,"guid":"db3b3745-c69c-4d75-8b80-ed90c0450ae1","subtype":"command","commandType":"auto","position":6.0,"command":"%md\n#### Q4- Exploring table directory\n\nExplore the table directory using the **%fs** magic command.\n\n**Hint:** get the table location from the above metadata information","commandVersion":54,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"3fe295de-5889-41ad-84bd-61ed64942539"},{"version":"CommandV1","origId":325513904362765,"guid":"da4f48df-b73f-42aa-a858-efef68064a74","subtype":"command","commandType":"auto","position":7.0,"command":"%fs ls 'dbfs:/user/hive/warehouse/persons'","commandVersion":18,"state":"finished","results":{"type":"table","data":[["dbfs:/user/hive/warehouse/persons/_delta_log/","_delta_log/",0,1694392607000],["dbfs:/user/hive/warehouse/persons/part-00000-1889be39-2ece-498c-b22e-56676cc527bb-c000.snappy.parquet","part-00000-1889be39-2ece-498c-b22e-56676cc527bb-c000.snappy.parquet",1037,1694392599000],["dbfs:/user/hive/warehouse/persons/part-00000-a0a27b89-ce3f-4c19-b12e-128956bd610e-c000.snappy.parquet","part-00000-a0a27b89-ce3f-4c19-b12e-128956bd610e-c000.snappy.parquet",1037,1694392606000],["dbfs:/user/hive/warehouse/persons/part-00000-c8d90368-0273-4188-813a-12bea15f8a94-c000.snappy.parquet","part-00000-c8d90368-0273-4188-813a-12bea15f8a94-c000.snappy.parquet",1037,1694392601000],["dbfs:/user/hive/warehouse/persons/part-00000-dfb3e6f5-1c5e-40b1-8ce9-fa13b5873186-c000.snappy.parquet","part-00000-dfb3e6f5-1c5e-40b1-8ce9-fa13b5873186-c000.snappy.parquet",1034,1694392597000],["dbfs:/user/hive/warehouse/persons/part-00000-ed9b35e5-5b1d-4851-8269-b257a322ea96-c000.snappy.parquet","part-00000-ed9b35e5-5b1d-4851-8269-b257a322ea96-c000.snappy.parquet",1034,1694392603000]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"path","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"size","type":"\"long\"","metadata":"{}"},{"name":"modificationTime","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1694392650168,"submitTime":1694392650144,"finishTime":1694392651118,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",6]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"cafce63d-8e7f-48f5-8877-d5cf291be77a"},{"version":"CommandV1","origId":325513904362766,"guid":"c99a8c27-02b3-49b3-bbf4-a595e98cf781","subtype":"command","commandType":"auto","position":7.5,"command":"%md\n#### Q5- Exploring the transactions log\n\nExplore the **_delta_log** subfolder in the table directory","commandVersion":21,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"54672617-eb05-412c-b1a1-4061087f13c5"},{"version":"CommandV1","origId":325513904362767,"guid":"481eb03f-f6f0-4f43-8b18-4f231c9731d1","subtype":"command","commandType":"auto","position":7.75,"command":"%fs ls 'dbfs:/user/hive/warehouse/persons/_delta_log'","commandVersion":8,"state":"finished","results":{"type":"table","data":[["dbfs:/user/hive/warehouse/persons/_delta_log/00000000000000000000.crc","00000000000000000000.crc",2046,1694392597000],["dbfs:/user/hive/warehouse/persons/_delta_log/00000000000000000000.json","00000000000000000000.json",1023,1694392595000],["dbfs:/user/hive/warehouse/persons/_delta_log/00000000000000000001.crc","00000000000000000001.crc",2558,1694392599000],["dbfs:/user/hive/warehouse/persons/_delta_log/00000000000000000001.json","00000000000000000001.json",1089,1694392598000],["dbfs:/user/hive/warehouse/persons/_delta_log/00000000000000000002.crc","00000000000000000002.crc",3066,1694392601000],["dbfs:/user/hive/warehouse/persons/_delta_log/00000000000000000002.json","00000000000000000002.json",1090,1694392599000],["dbfs:/user/hive/warehouse/persons/_delta_log/00000000000000000003.crc","00000000000000000003.crc",3574,1694392602000],["dbfs:/user/hive/warehouse/persons/_delta_log/00000000000000000003.json","00000000000000000003.json",1090,1694392601000],["dbfs:/user/hive/warehouse/persons/_delta_log/00000000000000000004.crc","00000000000000000004.crc",3574,1694392605000],["dbfs:/user/hive/warehouse/persons/_delta_log/00000000000000000004.json","00000000000000000004.json",1712,1694392603000],["dbfs:/user/hive/warehouse/persons/_delta_log/00000000000000000005.crc","00000000000000000005.crc",3575,1694392607000],["dbfs:/user/hive/warehouse/persons/_delta_log/00000000000000000005.json","00000000000000000005.json",1719,1694392606000],["dbfs:/user/hive/warehouse/persons/_delta_log/__tmp_path_dir/","__tmp_path_dir/",0,1694392607000]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"path","type":"\"string\"","metadata":"{}"},{"name":"name","type":"\"string\"","metadata":"{}"},{"name":"size","type":"\"long\"","metadata":"{}"},{"name":"modificationTime","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1694392691750,"submitTime":1694392691707,"finishTime":1694392692019,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",13]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"78ede217-5cf1-4e61-990e-aaf77f49d5a1"}],"dashboards":[],"guid":"2e641193-8c11-45ed-9df9-fe198975f93f","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4,"mostRecentlyExecutedCommandWithImplicitDF":{"commandId":3139962348493846,"dataframes":["_sqldf"]}},"reposExportFormat":"SOURCE"}