{"version":"NotebookV1","origId":325513904363036,"name":"4.2L - Jobs - Land New Data","language":"python","commands":[{"version":"CommandV1","origId":325513904363037,"guid":"60d998e2-790a-4061-88bc-7fa832f1d8c4","subtype":"command","commandType":"auto","position":0.5,"command":"%md\n\n## Lab: Creating a multi-task job\n\nIn this lab, we will create a job that has 2 tasks:\n1. The current notebook that lands a new batch of data in the lab dataset directory\n1. The Delta Live Table pipeline created in the previous lab to processes this data\n\n* Help: <a href=\"https://docs.databricks.com/workflows/jobs/create-run-jobs.html\" target=\"_blank\">Databricks Jobs documentation</a>.","commandVersion":55,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"46899dec-0606-43a6-b641-7c74e3ff0b15"},{"version":"CommandV1","origId":325513904363038,"guid":"b82a5003-aef5-4e39-b0da-55e7d3171286","subtype":"command","commandType":"auto","position":0.75,"command":"%md-sandbox\n\n<div  style=\"text-align: center; line-height: 0; padding-top: 9px;\">\n  <img src=\"https://raw.githubusercontent.com/derar-alhussein/Databricks-Certified-Data-Engineer-Associate/main/Labs/Includes/images/school_job.png\">\n</div>","commandVersion":6,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"233a730b-d5d0-46cd-b858-45ea0eb38f09"},{"version":"CommandV1","origId":325513904363039,"guid":"e750b8cc-0c1b-477f-ae35-bcede40ed6a8","subtype":"command","commandType":"auto","position":1.0,"command":"%md\n#### Q1- Configuring Task 1 -  Land New Data\n\n\nFrom the **Workflows** button on the sidebar, under the **Jobs** tab, click the **Create Job** button.\n\n<br>\n\n1. Set the job name in the top-left of the screen to **School Job** \n1. Configure the first task as specified below:\n| Setting | Value |\n|--|--|\n| Task name | Enter **Land New Data** |\n| Type | Choose **Notebook** |\n| Source | Choose **Workspace** |\n| Path | Use the navigator to choose the current notebook (4.2L - Jobs - Land New Data) |\n| Cluster | Select your cluster from the dropdown, under **Existing All Purpose Clusters** |\n\n\n<br>\n\n3. Click the **Create** button","commandVersion":126,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b6a598c0-c14a-43cd-b52d-e1d7cbad257b"},{"version":"CommandV1","origId":325513904363040,"guid":"f0c59862-fdbe-456b-8091-b7be3fa00679","subtype":"command","commandType":"auto","position":1.5,"command":"%md\n#### Q2- Configuring Task 2 - DLT pipeline\n\n<br>\n\n1. Click the add button (**+**) to add a new **Delta Live Tables pipeline** task \n1. Configure the task:\n\n| Setting | Value |\n|--|--|\n| Task name | Enter **DLT pipeline** |\n| Type | Choose **Delta Live Tables pipeline** |\n| Pipeline | Choose the DLT pipeline created in the previous lab |\n| Depends on | Choose **Land New Data**, which is the previous task we defined above |\n\n<br>\n\n3. Click the **Create task** button","commandVersion":65,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"03b9bc44-1483-45f7-9484-5865e3b3d637"},{"version":"CommandV1","origId":325513904363041,"guid":"26eec9d9-e1db-40ec-9478-7c1745af9590","subtype":"command","commandType":"auto","position":1.75,"command":"%md\n#### Q3- Run the job \n\nClick the **Run now** button in the top right to run this job. From the **Runs** tab, check your job run","commandVersion":30,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"9bce4858-b2cf-48fa-8c3f-e055b898dbdb"},{"version":"CommandV1","origId":325513904363042,"guid":"ba104405-3445-4594-98ae-3d359eb7046f","subtype":"command","commandType":"auto","position":1.875,"command":"%md\n#### Q4- Review the finished job \n\nOnce all tasks completed successfully, review the contents of each task to verify its result","commandVersion":18,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"29ffeace-f1e3-4953-93cf-b3bec18121df"},{"version":"CommandV1","origId":325513904363043,"guid":"5ef17c89-7b50-4e07-b690-67e93a3d1cc2","subtype":"command","commandType":"auto","position":1.90625,"command":"%md\n> **Note**: The below cells are to be run as part of the **Task 1** to land new batch of data in the dataset directory","commandVersion":29,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b6debd2a-d526-42b2-9fec-c880338848fc"},{"version":"CommandV1","origId":325513904363044,"guid":"99f6af7b-4607-4267-8b58-08afefd9daca","subtype":"command","commandType":"auto","position":1.9375,"command":"%run ../Includes/Setup-Lab","commandVersion":7,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"2c80a1da-8e26-4f69-be9e-5b3449a45a47"},{"version":"CommandV1","origId":325513904363045,"guid":"288a5f57-fa6d-452b-b942-01aa4bba8928","subtype":"command","commandType":"auto","position":3.0,"command":"load_new_json_data()","commandVersion":1,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"8797fb56-6e21-466c-9bae-420b0acf3f2f"}],"dashboards":[],"guid":"b8e528c7-779a-4579-b7d3-cc5ab97a19b2","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":2},"reposExportFormat":"SOURCE"}