{"version":"NotebookV1","origId":325513904362919,"name":"3.1L - Spark Structured Streaming","language":"python","commands":[{"version":"CommandV1","origId":325513904362920,"guid":"78f9f4ae-9ed0-4205-8076-4a1270cbcc48","subtype":"command","commandType":"auto","position":0.125,"command":"%md\n\n## Lab: Spark Structured Streaming","commandVersion":3,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"1192687b-c564-4249-9a72-b916499c12df"},{"version":"CommandV1","origId":325513904362921,"guid":"e608e2ac-28be-4e58-bb94-8fb76a681932","subtype":"command","commandType":"auto","position":0.1875,"command":"%md-sandbox\n\n<div  style=\"text-align: center; line-height: 0; padding-top: 9px;\">\n  <img src=\"https://raw.githubusercontent.com/derar-alhussein/Databricks-Certified-Data-Engineer-Associate/main/Labs/Includes/images/school_schema.png\" alt=\"School Schema\" style=\"width: 600\">\n</div>","commandVersion":8,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"da889b9a-adfe-40f9-87e9-ae13d0a0652c"},{"version":"CommandV1","origId":325513904362922,"guid":"99ee0292-b45a-457b-b2c3-79e916bf7381","subtype":"command","commandType":"auto","position":0.25,"command":"%md\nRun the following cell to setup the lab environment","commandVersion":2,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"56e9f857-fa72-4852-b5c9-ac6dd7bbfc04"},{"version":"CommandV1","origId":325513904362923,"guid":"b061e1cc-26a8-4717-8cb7-168304156a1a","subtype":"command","commandType":"auto","position":0.5,"command":"%run ../Includes/Setup-Lab","commandVersion":2,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1694358459765,"submitTime":1694358459677,"finishTime":1694358462206,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"bb37304a-44c4-4767-b2a3-1a20349a85c6"},{"version":"CommandV1","origId":325513904362924,"guid":"dc5c2db5-b896-4cf8-b402-2730b16b6cca","subtype":"script","commandType":"auto","position":0.6,"command":"","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1694358459765,"submitTime":0,"finishTime":1694358460085,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["b061e1cc-26a8-4717-8cb7-168304156a1a"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"1b6f66e9-94e8-41cb-9b82-de4c3370cd20"},{"version":"CommandV1","origId":325513904362925,"guid":"9a0bbd24-1cd3-4446-a0b5-ffaab2b13dd2","subtype":"script","commandType":"auto","position":0.7,"command":"","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1694358460116,"submitTime":0,"finishTime":1694358460186,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["b061e1cc-26a8-4717-8cb7-168304156a1a"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"cb67f539-0206-45d1-8de8-308677e736fe"},{"version":"CommandV1","origId":325513904362926,"guid":"7eba82d4-bca4-4b42-bc7c-4156e7c7e854","subtype":"script","commandType":"auto","position":0.8,"command":"","commandVersion":52,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1694358460201,"submitTime":0,"finishTime":1694358460488,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["b061e1cc-26a8-4717-8cb7-168304156a1a"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a6ceb287-6345-4826-acca-92679721e2f1"},{"version":"CommandV1","origId":325513904362927,"guid":"fdad32a9-a2e4-4d05-af68-32cf2436d7f1","subtype":"script","commandType":"auto","position":0.9,"command":"","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1694358460500,"submitTime":0,"finishTime":1694358460590,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["b061e1cc-26a8-4717-8cb7-168304156a1a"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ee354ed6-5863-4e0e-997f-81a91dc42fd8"},{"version":"CommandV1","origId":325513904362928,"guid":"7d2ce1d0-5bc5-4a78-994f-c1b02b16b871","subtype":"command","commandType":"auto","position":0.9375,"command":"%md\n#### Q1- Auto Loader\n\nUse Auto Loader to incrementally load enrollments json files from the directory **{dataset_school}/enrollments-json-raw** into a streaming view called **`enrollments_tmp_vw`**\n","commandVersion":91,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"37991b78-9eb3-4e90-9a43-1114a4514688"},{"version":"CommandV1","origId":325513904362929,"guid":"2596cf4d-2e68-42ed-8ad1-2a9b20b4bc70","subtype":"command","commandType":"auto","position":1.0,"command":"dataset_source = f\"{dataset_school}/enrollments-json-raw\"\nschema_location = \"dbfs:/mnt/DE-Associate/checkpoints/school/enrollments_stats\"\n\n\n(spark\n  .readStream\n  .___________________\n  .___________________\n  .____________________\n  .load(dataset_source)\n  .createOrReplaceTempView(\"enrollments_tmp_vw\"))","commandVersion":69,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1694358462234,"submitTime":1694358459885,"finishTime":1694358463301,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"b2ba3094-4591-4c15-b0c5-cae6e2181519"},{"version":"CommandV1","origId":325513904362930,"guid":"835a72da-6408-4d30-86fc-f86095f41712","subtype":"script","commandType":"auto","position":1.0,"command":"","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1694358460600,"submitTime":0,"finishTime":1694358460691,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["b061e1cc-26a8-4717-8cb7-168304156a1a"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"49ea93ab-e6d2-4f91-b45c-5589b6f3990c"},{"version":"CommandV1","origId":325513904362931,"guid":"354124b5-b248-4062-a5b7-9e50de8bb1db","subtype":"script","commandType":"auto","position":1.1,"command":"","commandVersion":1,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1694358460708,"submitTime":0,"finishTime":1694358460793,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["b061e1cc-26a8-4717-8cb7-168304156a1a"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"e618bfba-990e-4208-8108-3f4d75bf14d7"},{"version":"CommandV1","origId":325513904362932,"guid":"b0eaffc1-b7e9-4747-ae7f-ba902b9e73d6","subtype":"script","commandType":"auto","position":1.2,"command":"","commandVersion":5,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1694358460804,"submitTime":0,"finishTime":1694358460894,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["b061e1cc-26a8-4717-8cb7-168304156a1a"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"cb51512f-0d8a-467b-bc8c-fdf567d0b2b8"},{"version":"CommandV1","origId":325513904362933,"guid":"3df09030-a55e-448d-a0fe-3a8f22574876","subtype":"script","commandType":"auto","position":1.3,"command":"","commandVersion":22,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1694358460903,"submitTime":0,"finishTime":1694358460995,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["b061e1cc-26a8-4717-8cb7-168304156a1a"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"d1165413-3a58-461c-8e7a-060aeddc033d"},{"version":"CommandV1","origId":325513904362934,"guid":"0caf1980-4583-47a1-85ce-86df34e8edde","subtype":"script","commandType":"auto","position":1.4,"command":"","commandVersion":40,"state":"finished","results":{"type":"listResults","data":[{"type":"ansi","data":"Schema for the hands-on labs: DE_Associate_Labs\n","name":"stdout","arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1694358461006,"submitTime":0,"finishTime":1694358462206,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":["b061e1cc-26a8-4717-8cb7-168304156a1a"],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["ansi",48]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"a2966457-3620-4928-972e-fdae834d611b"},{"version":"CommandV1","origId":325513904362935,"guid":"b1975258-0f2d-4081-a10d-46f47b837385","subtype":"command","commandType":"auto","position":1.5,"command":"%md\n#### Q2 - Calculating aggregations on streaming data\n\nUsing CTAS syntax, define a new streaming view against **`enrollments_tmp_vw`** to count the number of enrollments per **`student_id`**. Name the aggregated field: **`enrollments_counts`**","commandVersion":106,"state":"finished","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":null,"subcommandOptions":null,"contentSha256Hex":null,"nuid":"80487c38-172f-4071-b670-3a53b8b8f3e3"},{"version":"CommandV1","origId":325513904362936,"guid":"df5c4adc-5b22-4100-b765-69c7f3b50958","subtype":"command","commandType":"auto","position":1.75,"command":"%sql\n\nCREATE OR REPLACE TEMPORARY VIEW enrollments_per_student_tmp_vw AS\nSELECT ___________________\n","commandVersion":51,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[],"columnCustomDisplayInfos":{},"metadata":{"dataframeName":null}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1694358565711,"submitTime":1694358565690,"finishTime":1694358565777,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000,"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",0]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"ad27453e-0614-4c36-9d28-f9dd89a4b5fe"},{"version":"CommandV1","origId":325513904362937,"guid":"d3d20626-e172-4804-9d40-f0d195efa4b5","subtype":"command","commandType":"auto","position":1.875,"command":"%md\n#### Q3 - Writing stream data\n\nStream the aggregated data from the **`enrollments_per_student_tmp_vw`** view to a Delta table called **`enrollments_stats`**.","commandVersion":25,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"5edf6802-b5a0-4654-9e08-eef1f9dd94b1"},{"version":"CommandV1","origId":325513904362938,"guid":"b3eee923-9a97-4434-b348-50dcb03e7567","subtype":"command","commandType":"auto","position":1.9375,"command":"checkpoint_path = \"dbfs:/mnt/DE-Associate/checkpoints/school/enrollments_stats\"\n\nquery = (spark._________________\n              ._________________\n              ._________________\n              ._________________\n              ._________________\n        )","commandVersion":64,"state":"finished","results":{"type":"listResults","data":[],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[],"metadata":{"isDbfsCommandResult":false}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1694359832227,"submitTime":1694359832227,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000},"streamStates":{"52717628-755b-4b75-9668-cc885d445533":[{"name":"52717628-755b-4b75-9668-cc885d445533","isActive":true,"sources":[],"sink":null,"exception":null,"version":2,"progressJson":null},{"name":"52717628-755b-4b75-9668-cc885d445533","isActive":true,"sources":[],"sink":null,"exception":null,"version":2,"progressJson":null},{"name":"52717628-755b-4b75-9668-cc885d445533","isActive":true,"sources":[],"sink":null,"exception":null,"version":2,"progressJson":"{\"name\":null,\"timestamp\":\"2023-09-10T15:30:33.266Z\",\"inputRowsPerSecond\":0.0,\"id\":\"12fd6d5b-f0ea-47b5-8f94-e239eef5c711\",\"durationMs\":{\"latestOffset\":4,\"triggerExecution\":4},\"stateOperators\":[],\"processedRowsPerSecond\":0.0}"},{"name":"52717628-755b-4b75-9668-cc885d445533","isActive":false,"sources":[],"sink":null,"exception":null,"version":2,"progressJson":null}]},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"2418756e-ec56-4dee-bfce-d6efdc318824"},{"version":"CommandV1","origId":325513904362939,"guid":"1d0cae45-146d-4666-92ab-f6cc11c72924","subtype":"command","commandType":"auto","position":1.96875,"command":"%md\n\nRun the below cell to ensure data was written as expected in the **enrollments_stats** table","commandVersion":25,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"1c56e1db-5e5a-4fe2-a908-13a740e794ae"},{"version":"CommandV1","origId":325513904362940,"guid":"fa2501bd-ace1-4384-8f1c-4a29009f08fe","subtype":"command","commandType":"auto","position":1.984375,"command":"%sql\nSELECT * FROM enrollments_stats","commandVersion":8,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[["S00844",1],["S00601",2],["S00943",1],["S01044",1],["S01150",1],["S00671",2],["S00667",2],["S00904",1],["S01005",1],["S00884",1],["S01056",1],["S00569",2],["S01029",1],["S00560",2],["S01178",1],["S00781",2],["S00516",2],["S00501",2],["S00700",2],["S00803",1],["S00622",2],["S00564",2],["S00823",1],["S01174",1],["S00967",1],["S00836",1],["S00510",2],["S00930",1],["S00841",1],["S00728",2],["S01061",1],["S00503",2],["S01162",1],["S00617",2],["S00758",2],["S00820",1],["S01052",1],["S01097",1],["S00974",1],["S01156",1],["S00697",2],["S00957",1],["S00773",2],["S00954",1],["S01070",1],["S00567",2],["S00684",2],["S00729",2],["S00848",1],["S01060",1],["S00536",2],["S00960",1],["S00529",2],["S00840",1],["S00744",2],["S00519",2],["S00607",2],["S00726",2],["S00766",2],["S00910",1],["S00668",2],["S00609",2],["S00694",2],["S00761",2],["S00737",2],["S00767",2],["S00805",1],["S01165",1],["S00580",2],["S01149",1],["S01078",1],["S00615",2],["S01007",1],["S00970",1],["S01112",1],["S01049",1],["S00587",2],["S00613",2],["S01024",1],["S00860",1],["S00654",2],["S00699",2],["S00561",2],["S00566",2],["S00927",1],["S00509",2],["S00494",2],["S00764",2],["S01185",1],["S00600",2],["S00521",2],["S00777",2],["S00899",1],["S01163",1],["S00690",2],["S01040",1],["S00870",1],["S00605",2],["S00982",1],["S00511",2],["S00790",2],["S00666",2],["S00707",2],["S01014",1],["S01035",1],["S00934",1],["S01182",1],["S00983",1],["S00912",1],["S00672",2],["S01067",1],["S01009",1],["S01000",1],["S01188",1],["S01167",1],["S00838",1],["S00756",2],["S01077",1],["S00978",1],["S01032",1],["S00842",1],["S01093",1],["S01010",1],["S00988",1],["S01100",1],["S01086",1],["S00625",2],["S00575",2],["S00750",2],["S00546",2],["S00598",2],["S01130",1],["S00853",1],["S00881",1],["S00542",2],["S00557",2],["S00627",2],["S00650",2],["S00602",2],["S00926",1],["S00577",2],["S00754",2],["S00918",1],["S00846",1],["S00588",2],["S00769",2],["S00857",1],["S00806",1],["S01073",1],["S01131",1],["S00597",2],["S00593",2],["S00872",1],["S00725",2],["S00619",2],["S00849",1],["S00709",2],["S00779",2],["S01108",1],["S00553",2],["S00582",2],["S00637",2],["S00524",2],["S00995",1],["S00972",1],["S00932",1],["S00512",2],["S00931",1],["S01116",1],["S00924",1],["S00837",1],["S00584",2],["S01055",1],["S00953",1],["S00892",1],["S01028",1],["S01088",1],["S00845",1],["S01145",1],["S01054",1],["S00863",1],["S01079",1],["S00774",2],["S01075",1],["S01137",1],["S00520",2],["S01122",1],["S00976",1],["S00543",2],["S00674",2],["S01012",1],["S01136",1],["S00850",1],["S01085",1],["S00705",2],["S01063",1],["S01016",1],["S00923",1],["S00656",2],["S00592",2],["S01076",1],["S00959",1],["S00867",1],["S00901",1],["S00614",2],["S00962",1],["S01031",1],["S00936",1],["S00502",2],["S01037",1],["S00746",2],["S01177",1],["S00547",2],["S00683",2],["S00624",2],["S00941",1],["S00753",2],["S01022",1],["S00531",2],["S00735",2],["S01036",1],["S01080",1],["S00868",1],["S00835",1],["S01046",1],["S00933",1],["S00984",1],["S01113",1],["S00550",2],["S00780",2],["S01124",1],["S01161",1],["S00975",1],["S00661",2],["S00925",1],["S01186",1],["S00859",1],["S00610",2],["S00749",2],["S01011",1],["S00747",2],["S01090",1],["S01025",1],["S00658",2],["S00523",2],["S00792",2],["S00685",2],["S01180",1],["S01103",1],["S00770",2],["S00583",2],["S01132",1],["S01059",1],["S01181",1],["S00829",1],["S00540",2],["S00646",2],["S01109",1],["S00647",2],["S00645",2],["S00883",1],["S00692",2],["S00843",1],["S00515",2],["S00571",2],["S00878",1],["S00497",2],["S00909",1],["S00748",2],["S00866",1],["S00784",2],["S01118",1],["S01098",1],["S00947",1],["S00723",2],["S00499",2],["S00794",1],["S00862",1],["S00632",2],["S00759",2],["S01089",1],["S01141",1],["S01158",1],["S00763",2],["S00522",2],["S00538",2],["S00745",2],["S00945",1],["S00630",2],["S00673",2],["S01071",1],["S01053",1],["S00585",2],["S00664",2],["S00992",1],["S00832",1],["S00813",1],["S01064",1],["S00662",2],["S00635",2],["S00558",2],["S01095",1],["S00556",2],["S01034",1],["S00891",1],["S00839",1],["S00997",1],["S00513",2],["S00611",2],["S01138",1],["S01152",1],["S01062",1],["S00514",2],["S00518",2],["S00599",2],["S00809",1],["S00985",1],["S00887",1],["S01104",1],["S00714",2],["S00919",1],["S00922",1],["S00604",2],["S00649",2],["S00877",1],["S01033",1],["S00987",1],["S00999",1],["S00908",1],["S01106",1],["S00996",1],["S01169",1],["S00586",2],["S00634",2],["S00760",2],["S00855",1],["S00890",1],["S00831",1],["S00539",2],["S00717",2],["S01094",1],["S00621",2],["S00905",1],["S00533",2],["S01184",1],["S00757",2],["S00994",1],["S00670",2],["S00702",2],["S01017",1],["S00663",2],["S00532",2],["S00876",1],["S01074",1],["S01057",1],["S00659",2],["S01155",1],["S00724",2],["S01173",1],["S01176",1],["S00755",2],["S00914",1],["S01107",1],["S00570",2],["S00952",1],["S01015",1],["S01117",1],["S01023",1],["S00618",2],["S00537",2],["S01102",1],["S01101",1],["S00686",2],["S00830",1],["S00695",2],["S01179",1],["S01001",1],["S00888",1],["S00651",2],["S00968",1],["S01160",1],["S00851",1],["S00789",2],["S00496",2],["S01115",1],["S01047",1],["S00623",2],["S01083",1],["S00929",1],["S01105",1],["S00795",1],["S00819",1],["S00576",2],["S00964",1],["S00648",2],["S00698",2],["S00541",2],["S00517",2],["S01170",1],["S00739",2],["S00688",2],["S00655",2],["S01166",1],["S00636",2],["S00608",2],["S00875",1],["S00783",2],["S01120",1],["S00785",2],["S00993",1],["S00827",1],["S00986",1],["S01146",1],["S00669",2],["S00679",2],["S01123",1],["S00548",2],["S00677",2],["S00703",2],["S00858",1],["S00581",2],["S00885",1],["S00676",2],["S01082",1],["S00915",1],["S00675",2],["S00508",2],["S01068",1],["S00864",1],["S00825",1],["S00793",2],["S00981",1],["S00893",1],["S00816",1],["S00939",1],["S00652",2],["S00740",2],["S00594",2],["S00826",1],["S01191",1],["S00568",2],["S00847",1],["S00889",1],["S00818",1],["S00977",1],["S00873",1],["S00898",1],["S00620",2],["S01006",1],["S01154",1],["S01134",1],["S00563",2],["S00495",2],["S00545",2],["S00911",1],["S00733",2],["S00861",1],["S00903",1],["S01019",1],["S01133",1],["S01153",1],["S00979",1],["S00865",1],["S00902",1],["S00990",1],["S00811",1],["S00971",1],["S01157",1],["S00687",2],["S00701",2],["S01039",1],["S00762",2],["S00629",2],["S01041",1],["S01038",1],["S00797",1],["S01183",1],["S00713",2],["S00708",2],["S01092",1],["S00921",1],["S00956",1],["S01050",1],["S00678",2],["S01190",1],["S00643",2],["S00958",1],["S01139",1],["S00812",1],["S00751",2],["S01147",1],["S00802",1],["S00752",2],["S00788",2],["S01187",1],["S00525",2],["S00989",1],["S01096",1],["S00928",1],["S00808",1],["S00526",2],["S01026",1],["S00591",2],["S01058",1],["S00544",2],["S00706",2],["S00801",1],["S00682",2],["S01148",1],["S00534",2],["S00961",1],["S00665",2],["S01125",1],["S01018",1],["S00963",1],["S00916",1],["S00742",2],["S00815",1],["S00768",2],["S01127",1],["S00681",2],["S01135",1],["S00897",1],["S00955",1],["S00507",2],["S00998",1],["S00854",1],["S00771",2],["S00721",2],["S00640",2],["S00946",1],["S00950",1],["S00821",1],["S00653",2],["S01164",1],["S00596",2],["S00641",2],["S00498",2],["S00937",1],["S00555",2],["S00879",1],["S00535",2],["S00895",1],["S00691",2],["S00810",1],["S00949",1],["S00796",1],["S00710",2],["S00504",2],["S00980",1],["S00833",1],["S00696",2],["S00559",2],["S00572",2],["S01172",1],["S00804",1],["S00565",2],["S01143",1],["S01189",1],["S01114",1],["S00942",1],["S00800",1],["S00807",1],["S01119",1],["S00882",1],["S00824",1],["S01110",1],["S01129",1],["S00834",1],["S01175",1],["S01081",1],["S00817",1],["S01084",1],["S01065",1],["S01140",1],["S00920",1],["S01048",1],["S01159",1],["S00894",1],["S00799",1],["S01151",1],["S00896",1],["S00913",1],["S00935",1],["S01171",1],["S01013",1],["S00642",2],["S00718",2],["S00506",2],["S01168",1],["S01021",1],["S00871",1],["S00973",1],["S00966",1],["S01030",1],["S00869",1],["S00852",1],["S00917",1],["S00603",2],["S00722",2],["S00549",2],["S00631",2],["S00505",2],["S00730",2],["S00743",2],["S00530",2],["S00500",2],["S00906",1],["S00940",1],["S00798",1],["S00951",1],["S00874",1],["S00886",1],["S01042",1],["S01142",1],["S01099",1],["S01020",1],["S00814",1],["S01066",1],["S00578",2],["S00562",2],["S00765",2],["S00573",2],["S01111",1],["S00944",1],["S00720",2],["S00590",2],["S00528",2],["S00595",2],["S00786",2],["S00704",2],["S00693",2],["S00731",2],["S00719",2],["S00527",2],["S00787",2],["S00579",2],["S00716",2],["S00791",2],["S00554",2],["S00775",2],["S01126",1],["S00738",2],["S00969",1],["S00574",2],["S00822",1],["S00628",2],["S01091",1],["S00680",2],["S01045",1],["S00633",2],["S01051",1],["S00782",2],["S00900",1],["S00589",2],["S00907",1],["S00660",2],["S00948",1],["S00715",2],["S01003",1],["S00644",2],["S00639",2],["S01128",1],["S00727",2],["S00856",1],["S00657",2],["S01121",1],["S00616",2],["S00938",1],["S01072",1],["S00736",2],["S00778",2],["S01144",1],["S00606",2],["S00965",1],["S01069",1],["S01043",1],["S00689",2],["S00612",2],["S00551",2],["S01002",1],["S00828",1],["S00776",2],["S01087",1],["S00711",2],["S00991",1],["S01027",1],["S01004",1],["S01192",1],["S00712",2],["S00880",1],["S01008",1],["S00772",2],["S00552",2],["S00732",2],["S00741",2],["S01193",1],["S00734",2],["S00626",2],["S00638",2]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"student_id","type":"\"string\"","metadata":"{}"},{"name":"enrollments_count","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"student_id","nullable":true,"type":"string"},{"metadata":{},"name":"enrollments_count","nullable":true,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"columnCustomDisplayInfos":{},"metadata":{"dataframeName":"_sqldf","executionCount":15}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"student_id","nullable":true,"type":"string"},{"metadata":{},"name":"enrollments_count","nullable":true,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1694358699816,"submitTime":1694358699787,"finishTime":1694358705741,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000,"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",700]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"9182ca39-7214-4a5e-bf5e-685da8e99656"},{"version":"CommandV1","origId":325513904362941,"guid":"a7fd6b17-e2f0-4c28-829f-ce1d2728a441","subtype":"command","commandType":"auto","position":2.984375,"command":"%md\nRun the below cell to land a new json file of enrollments data","commandVersion":43,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"17b7f4b2-f24d-4a6b-ac50-f4bd5cc13259"},{"version":"CommandV1","origId":325513904362942,"guid":"550f17fb-a59c-43bb-b74b-76fd2845b0c6","subtype":"command","commandType":"auto","position":3.984375,"command":"load_new_json_data()","commandVersion":3,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"dc0e48c7-5a13-4ea2-b01a-c339fa8e7c6f"},{"version":"CommandV1","origId":325513904362943,"guid":"1caaee65-3c64-4bc5-8fc4-51b8eefd3636","subtype":"command","commandType":"auto","position":4.984375,"command":"%md\nVerify that the statistics have been updated in the table **enrollments_stats**","commandVersion":31,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"7cbd537e-7b51-45be-86b6-f4fdf7905b8a"},{"version":"CommandV1","origId":325513904362944,"guid":"58bf1f50-ba2a-46a9-beff-d5a3dd0e99c5","subtype":"command","commandType":"auto","position":5.984375,"command":"%sql\nSELECT * FROM enrollments_stats","commandVersion":7,"state":"finished","results":{"type":"listResults","data":[{"type":"table","data":[["S00844",2],["S01044",2],["S00671",4],["S00601",4],["S00943",2],["S01150",2],["S00667",4],["S00904",2],["S01005",2],["S00884",2],["S00569",4],["S01029",2],["S00560",4],["S01178",2],["S00781",4],["S00516",4],["S01056",2],["S00836",2],["S00930",2],["S00841",2],["S01162",2],["S00510",4],["S00728",4],["S01061",2],["S00503",4],["S00501",4],["S00700",4],["S00803",2],["S00622",4],["S00823",2],["S00967",2],["S00564",4],["S01174",2],["S01060",2],["S00840",2],["S00729",4],["S00848",2],["S00536",4],["S00960",2],["S00529",4],["S00744",4],["S00758",4],["S01052",2],["S01097",2],["S01156",2],["S00617",4],["S00820",2],["S00974",2],["S00509",4],["S00699",4],["S00561",4],["S00566",4],["S00927",2],["S00494",4],["S00764",4],["S00607",4],["S00668",4],["S00609",4],["S00519",4],["S00726",4],["S00766",4],["S00910",2],["S00761",4],["S00767",4],["S00580",4],["S00694",4],["S00737",4],["S00805",2],["S01165",2],["S00521",4],["S00899",2],["S01185",2],["S00600",4],["S00777",4],["S01163",2],["S00857",2],["S01073",2],["S00846",2],["S00588",4],["S00769",4],["S00806",2],["S01000",2],["S00838",2],["S00756",4],["S01188",2],["S01167",2],["S01077",2],["S00697",4],["S00954",2],["S00567",4],["S00957",2],["S00773",4],["S01070",2],["S00684",4],["S00709",4],["S01108",2],["S00553",4],["S00849",2],["S00779",4],["S00582",4],["S00593",4],["S00872",2],["S01131",2],["S00597",4],["S00725",4],["S00619",4],["S00690",4],["S01040",2],["S00982",2],["S00870",2],["S00605",4],["S00511",4],["S00613",4],["S01024",2],["S01049",2],["S00587",4],["S00860",2],["S00654",4],["S00790",4],["S00666",4],["S00707",4],["S01014",2],["S01035",2],["S00934",2],["S00575",4],["S00750",4],["S00546",4],["S00598",4],["S01086",2],["S00625",4],["S01182",2],["S00983",2],["S00912",2],["S00672",4],["S01067",2],["S01009",2],["S00853",2],["S00881",2],["S01130",2],["S00542",4],["S00557",4],["S00627",4],["S01078",2],["S01007",2],["S00970",2],["S01112",2],["S01149",2],["S00615",4],["S00754",4],["S00918",2],["S00650",4],["S00602",4],["S00926",2],["S00577",4],["S00524",4],["S00972",2],["S00512",4],["S00637",4],["S00995",2],["S00932",2],["S00931",2],["S01116",2],["S00924",2],["S00837",2],["S00584",4],["S01054",2],["S00863",2],["S01079",2],["S00774",4],["S01075",2],["S01137",2],["S00520",4],["S01122",2],["S00976",2],["S00543",4],["S00988",2],["S01100",2],["S00978",2],["S01032",2],["S00842",2],["S01093",2],["S01010",2],["S00674",4],["S01012",2],["S01136",2],["S00850",2],["S01085",2],["S00705",4],["S01063",2],["S01016",2],["S00923",2],["S00656",4],["S00592",4],["S01076",2],["S00959",2],["S00867",2],["S00901",2],["S00614",4],["S00962",2],["S01031",2],["S00936",2],["S00502",4],["S01037",2],["S00746",4],["S01177",2],["S00547",4],["S00683",4],["S00624",4],["S00941",2],["S00753",4],["S01022",2],["S00531",4],["S01028",2],["S01055",2],["S00953",2],["S00892",2],["S01088",2],["S00845",2],["S01145",2],["S00735",4],["S01036",2],["S01080",2],["S00868",2],["S00835",2],["S01046",2],["S00933",2],["S00984",2],["S01113",2],["S00550",4],["S00780",4],["S01124",2],["S01161",2],["S00975",2],["S00661",4],["S00925",2],["S01186",2],["S00859",2],["S00610",4],["S00749",4],["S01011",2],["S00747",4],["S01090",2],["S01025",2],["S00658",4],["S00523",4],["S00792",4],["S00685",4],["S01180",2],["S01103",2],["S00770",4],["S00583",4],["S01132",2],["S01059",2],["S01181",2],["S00829",2],["S00540",4],["S00646",4],["S01109",2],["S00647",4],["S00645",4],["S00883",2],["S00692",4],["S00843",2],["S00515",4],["S00571",4],["S00878",2],["S00497",4],["S00909",2],["S00748",4],["S00866",2],["S00784",4],["S01118",2],["S01098",2],["S00947",2],["S00723",4],["S00499",4],["S00794",2],["S00862",2],["S00632",4],["S00759",4],["S01089",2],["S01141",2],["S01158",2],["S00763",4],["S00522",4],["S00538",4],["S00745",4],["S00945",2],["S00630",4],["S00673",4],["S01071",2],["S01053",2],["S00585",4],["S00664",4],["S00992",2],["S00832",2],["S00813",2],["S01064",2],["S00662",4],["S00635",4],["S00558",4],["S01095",2],["S00556",4],["S01034",2],["S00891",2],["S00839",2],["S00997",2],["S00513",4],["S00611",4],["S01138",2],["S01152",2],["S01062",2],["S00514",4],["S00518",4],["S00599",4],["S00809",2],["S00985",2],["S00887",2],["S01104",2],["S00714",4],["S00919",2],["S00922",2],["S00604",4],["S00649",4],["S00996",2],["S01169",2],["S00586",4],["S00634",4],["S00760",4],["S00855",2],["S00890",2],["S00831",2],["S00539",4],["S00717",4],["S01094",2],["S00621",4],["S00905",2],["S00987",2],["S00999",2],["S01106",2],["S00877",2],["S01033",2],["S00908",2],["S00533",4],["S01184",2],["S00757",4],["S00994",2],["S00670",4],["S00702",4],["S01017",2],["S00663",4],["S00532",4],["S00876",2],["S01074",2],["S01057",2],["S00659",4],["S01155",2],["S00724",4],["S01173",2],["S01176",2],["S00755",4],["S00914",2],["S01107",2],["S00570",4],["S00952",2],["S01015",2],["S01117",2],["S01023",2],["S00618",4],["S00537",4],["S01102",2],["S01101",2],["S00686",4],["S00830",2],["S00695",4],["S01179",2],["S01001",2],["S00888",2],["S00651",4],["S00968",2],["S01160",2],["S00851",2],["S00789",4],["S00496",4],["S01115",2],["S01047",2],["S00623",4],["S00576",4],["S00964",2],["S00648",4],["S00698",4],["S00541",4],["S00517",4],["S01170",2],["S00739",4],["S00688",4],["S00655",4],["S01166",2],["S00636",4],["S00608",4],["S00875",2],["S00783",4],["S01120",2],["S00785",4],["S00993",2],["S00827",2],["S00986",2],["S01146",2],["S00669",4],["S00679",4],["S01123",2],["S00548",4],["S00677",4],["S00703",4],["S00858",2],["S00581",4],["S00885",2],["S00676",4],["S01082",2],["S00915",2],["S00675",4],["S00508",4],["S01068",2],["S01083",2],["S00929",2],["S01105",2],["S00795",2],["S00819",2],["S00864",2],["S00825",2],["S00793",4],["S00981",2],["S00893",2],["S00816",2],["S00939",2],["S00652",4],["S00740",4],["S00594",4],["S00826",2],["S01191",2],["S00568",4],["S00847",2],["S00889",2],["S00818",2],["S00977",2],["S00873",2],["S00898",2],["S00620",4],["S01006",2],["S01154",2],["S01134",2],["S00563",4],["S00495",4],["S00545",4],["S00911",2],["S00733",4],["S00861",2],["S00903",2],["S01019",2],["S01133",2],["S01153",2],["S00979",2],["S00865",2],["S00902",2],["S00990",2],["S00811",2],["S00971",2],["S01157",2],["S00687",4],["S00701",4],["S01039",2],["S00762",4],["S00629",4],["S01041",2],["S01038",2],["S00797",2],["S01183",2],["S00713",4],["S00708",4],["S01092",2],["S00921",2],["S00956",2],["S01050",2],["S00678",4],["S01190",2],["S00643",4],["S00958",2],["S01139",2],["S00812",2],["S00751",4],["S01147",2],["S00802",2],["S00752",4],["S00788",4],["S01187",2],["S00525",4],["S00526",4],["S01026",2],["S00591",4],["S01058",2],["S00544",4],["S00706",4],["S00801",2],["S00682",4],["S01148",2],["S00534",4],["S00961",2],["S00665",4],["S00742",4],["S00815",2],["S00768",4],["S01127",2],["S00681",4],["S01135",2],["S00897",2],["S00955",2],["S00507",4],["S00998",2],["S00854",2],["S00771",4],["S00721",4],["S00640",4],["S00946",2],["S00950",2],["S00821",2],["S00653",4],["S01164",2],["S00596",4],["S00641",4],["S00498",4],["S00937",2],["S00555",4],["S00879",2],["S00535",4],["S00895",2],["S00691",4],["S00810",2],["S00949",2],["S00989",2],["S01096",2],["S00928",2],["S00808",2],["S00796",2],["S00710",4],["S00504",4],["S01125",2],["S01018",2],["S00963",2],["S00916",2],["S00980",2],["S00833",2],["S00696",4],["S00559",4],["S00572",4],["S01172",2],["S00804",2],["S00565",4],["S01143",2],["S01189",2],["S01114",2],["S00942",2],["S00800",2],["S00807",2],["S01119",2],["S00882",2],["S00824",2],["S01110",2],["S01129",2],["S00642",4],["S00718",4],["S00506",4],["S00834",2],["S01175",2],["S01081",2],["S00817",2],["S01084",2],["S01065",2],["S00603",4],["S00722",4],["S00549",4],["S01140",2],["S00920",2],["S01048",2],["S01159",2],["S00894",2],["S00799",2],["S00631",4],["S00505",4],["S00730",4],["S01151",2],["S00896",2],["S00913",2],["S00935",2],["S01171",2],["S01013",2],["S00743",4],["S00530",4],["S00500",4],["S01168",2],["S01021",2],["S00871",2],["S00973",2],["S00966",2],["S01030",2],["S00869",2],["S00852",2],["S00917",2],["S00578",4],["S00562",4],["S00765",4],["S00573",4],["S00720",4],["S00590",4],["S00528",4],["S00595",4],["S00786",4],["S00704",4],["S00693",4],["S00731",4],["S00527",4],["S00719",4],["S00787",4],["S00579",4],["S00716",4],["S00791",4],["S00554",4],["S00775",4],["S00940",2],["S00906",2],["S00798",2],["S00951",2],["S00874",2],["S00886",2],["S01042",2],["S01142",2],["S01099",2],["S01020",2],["S00814",2],["S01066",2],["S01111",2],["S00944",2],["S00727",4],["S00856",2],["S00574",4],["S00969",2],["S00628",4],["S00822",2],["S00657",4],["S01121",2],["S00616",4],["S00938",2],["S00778",4],["S01144",2],["S00606",4],["S00965",2],["S01126",2],["S00738",4],["S01128",2],["S00639",4],["S01091",2],["S00680",4],["S00711",4],["S00991",2],["S01045",2],["S00633",4],["S01051",2],["S00782",4],["S00900",2],["S00589",4],["S00907",2],["S00660",4],["S00948",2],["S00715",4],["S01003",2],["S00644",4],["S01069",2],["S01043",2],["S00689",4],["S00612",4],["S00551",4],["S01002",2],["S00828",2],["S00776",4],["S01087",2],["S01027",2],["S01004",2],["S01192",2],["S00712",4],["S00880",2],["S01072",2],["S00736",4],["S01008",2],["S00772",4],["S00552",4],["S00732",4],["S00741",4],["S01193",2],["S00734",4],["S00626",4],["S00638",4]],"arguments":{},"addedWidgets":{},"removedWidgets":[],"schema":[{"name":"student_id","type":"\"string\"","metadata":"{}"},{"name":"enrollments_count","type":"\"long\"","metadata":"{}"}],"overflow":false,"aggData":[],"aggSchema":[],"aggOverflow":false,"aggSeriesLimitReached":false,"aggError":"","aggType":"","plotOptions":null,"isJsonSchema":true,"dbfsResultPath":null,"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"student_id","nullable":true,"type":"string"},{"metadata":{},"name":"enrollments_count","nullable":true,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"columnCustomDisplayInfos":{},"metadata":{"dataframeName":"_sqldf","executionCount":22}}],"arguments":{},"addedWidgets":{},"removedWidgets":[],"datasetInfos":[{"name":"_sqldf","typeStr":"pyspark.sql.dataframe.DataFrame","schema":{"fields":[{"metadata":{},"name":"student_id","nullable":true,"type":"string"},{"metadata":{},"name":"enrollments_count","nullable":true,"type":"long"}],"type":"struct"},"tableIdentifier":null}],"metadata":{}},"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":1694359093841,"submitTime":1694359093822,"finishTime":1694359098704,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{"rowLimit":10000,"byteLimit":2048000,"implicitDf":true},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[["table",700]],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"0c028d73-0e8a-45d9-992e-fd79aa81fac0"},{"version":"CommandV1","origId":325513904362945,"guid":"4c5f4467-e1fb-4449-9ef8-193e8cdad1b4","subtype":"command","commandType":"auto","position":6.984375,"command":"%md\n#### Q4 - Canceling streaming query\n\nFinally, cancel the above streaming query","commandVersion":20,"state":"input","results":null,"resultDbfsStatus":"INLINED_IN_TREE","resultDbfsErrorMessage":null,"errorSummary":null,"errorTraceType":null,"error":null,"workflows":[],"startTime":0,"submitTime":0,"finishTime":0,"collapsed":false,"bindings":{},"inputWidgets":{},"displayType":"table","width":"auto","height":"auto","xColumns":null,"yColumns":null,"pivotColumns":null,"pivotAggregation":null,"useConsistentColors":false,"customPlotOptions":{},"commentThread":[],"commentsVisible":false,"parentHierarchy":[],"diffInserts":[],"diffDeletes":[],"globalVars":{},"latestUser":"a user","latestUserId":null,"commandTitle":"","showCommandTitle":false,"hideCommandCode":false,"hideCommandResult":false,"isLockedInExamMode":false,"iPythonMetadata":null,"metadata":{},"streamStates":{},"datasetPreviewNameToCmdIdMap":{},"tableResultIndex":null,"listResultMetadata":[],"subcommandOptions":null,"contentSha256Hex":null,"nuid":"9278ce3e-f6f2-438b-98ec-c653ebc9ec7b"}],"dashboards":[],"guid":"96dcdeff-90f5-434f-b7a6-e7a06c8396ed","globalVars":{},"iPythonMetadata":null,"inputWidgets":{},"notebookMetadata":{"pythonIndentUnit":4,"mostRecentlyExecutedCommandWithImplicitDF":{"commandId":4203503769578986,"dataframes":["_sqldf"]}},"reposExportFormat":"SOURCE"}